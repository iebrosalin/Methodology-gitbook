# A02:2021-Cryptographic Failures

Первое, что нужно сделать, это определить потребности в защите данных при передаче и в состоянии покоя. Например, пароли, номера кредитных карт, медицинские записи, личная информация и коммерческая тайна требуют дополнительной защиты, главным образом, если эти данные подпадают под действие законов о конфиденциальности, например, Общего регламента ЕС по защите данных (GDPR), или правил, например, защиты финансовых данных, таких как Стандарт безопасности данных PCI (PCI DSS).

* Передаются ли какие-либо данные открытым текстом? Это касается таких протоколов, как HTTP, SMTP, FTP, также использующих обновления TLS, такие как STARTTLS. Внешний интернет-трафик опасен. Проверьте весь внутренний трафик, например, между подсистемами балансировки нагрузки, веб-серверами или внутренними системами.
* Используются ли какие-либо старые или слабые криптографические алгоритмы или протоколы по умолчанию или в более старом коде?
* Используются ли крипто-ключи по умолчанию, сгенерированы или повторно использованы слабые крипто-ключи, или отсутствует надлежащее управление ключами или их ротация? Проверяются ли крипто-ключи в репозиториях исходного кода?
* Не применяется ли шифрование, например, отсутствуют ли какие-либо директивы безопасности HTTP-заголовков (браузера) или заголовки?
* Правильно ли проверен полученный сертификат сервера и цепочка доверия?
* Игнорируются ли векторы инициализации, используются ли они повторно или сгенерированы недостаточно безопасно для криптографического режима работы? Используется ли небезопасный режим работы, такой как ECB? Используется ли шифрование, когда аутентифицированное шифрование является более подходящим?
* Используются ли пароли в качестве криптографических ключей в отсутствие функции получения базового ключа пароля?
* Используется ли случайность в криптографических целях, которые не были разработаны для удовлетворения криптографических требований? Даже если выбрана правильная функция, нужно ли ее заполнять разработчиком, а если нет, переписал ли разработчик встроенную в нее мощную начальную функциональность с семенем, которому не хватает достаточной энтропии/непредсказуемости?
* Используются ли устаревшие хеш-функции, такие как MD5 или SHA1, или используются некриптографические хеш-функции, когда требуются криптографические хеш-функции?
* Используются ли устаревшие методы криптографического заполнения, такие как PKCS номер 1 v1.5?
* Можно ли использовать сообщения о криптографических ошибках или информацию о побочных каналах, например, в форме атак oracle с дополнением?

